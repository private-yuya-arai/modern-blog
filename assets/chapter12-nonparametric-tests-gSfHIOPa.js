const r=`---\r
slug: "nonparametric-tests-chapter12"\r
title: "ノンパラメトリック検定：データの形を問わない頼れる味方"\r
date: "2025-11-20"\r
category: "統計学"\r
tags: ["統計検定準一級", "Python", "R", "ノンパラメトリック", "ウィルコクソン", "順位和検定"]\r
excerpt: "「データが少ない」「偏りがひどい」「順位データしかない」。正規分布を仮定できない厳しい条件下でも使える、タフな検定手法たちを紹介。"\r
image: "/images/nonparametric.png"\r
---\r
\r
## この知識はいつ使うの？\r
\r
*   **データ数が極端に少ないとき**: $n=5$ くらいしかなくて、ヒストグラムを描いてもボコボコで正規分布かわからないとき。\r
*   **外れ値があるとき**: とんでもなく大きな値が1つ混ざっていて、平均値が使い物にならないとき。\r
*   **順位データ（アンケート）**: 「1位〜5位」のようなデータで、平均値を計算するのが適切でないとき。\r
\r
## パラメトリック vs ノンパラメトリック\r
\r
| 特徴 | パラメトリック (t検定など) | ノンパラメトリック (順位和検定など) |\r
| :--- | :--- | :--- |\r
| **前提条件** | データが特定の分布（正規分布など）に従うこと | **分布を仮定しない** (Distribution-free) |\r
| **使う統計量** | 平均値、分散 | **順位 (Rank)**、中央値 |\r
| **メリット** | 検出力が高い（差を見つけやすい） | どんなデータでも使える（頑健性） |\r
| **デメリット** | 前提が崩れると結果が間違っているかも | 情報の一部（具体的な値）を捨てるので、検出力は少し落ちる |\r
\r
## どの検定を選べばいい？ (対応表)\r
\r
t検定などに対応するノンパラメトリック版が必ず存在します。\r
\r
\`\`\`mermaid\r
graph TD\r
    Param["パラメトリック<br>(正規分布前提)"]\r
    NonParam["ノンパラメトリック<br>(分布不問)"]\r
    \r
    Param --> TInd["t検定<br>(独立2群)"]\r
    NonParam --> MWU["マン・ホイットニーのU検定<br>(ウィルコクソンの順位和検定)"]\r
    \r
    Param --> TPair["対応のあるt検定"]\r
    NonParam --> WSR["ウィルコクソンの符号付順位検定"]\r
    \r
    Param --> ANOVA["一元配置分散分析"]\r
    NonParam --> KW["クラスカル・ウォリス検定"]\r
\`\`\`\r
\r
## 仕組み：なぜ「順位」を使うのか？\r
\r
例えば \`[1, 2, 1000]\` というデータがあった時、平均値は \`334\` になりますが、これでは \`1000\` に引きずられすぎです。\r
これを順位に変換すると \`[1位, 2位, 3位]\` となり、\`1000\` という極端な値の影響（外れ値）をマイルドにできます。\r
\r
これがノンパラメトリック検定が「外れ値に強い」理由です。\r
\r
## Pythonでの実装：マン・ホイットニーのU検定\r
\r
独立な2群の比較（対応なしt検定の代わり）を行います。\r
\r
\`\`\`python\r
from scipy import stats\r
import numpy as np\r
\r
# A群：普通のデータ\r
group_A = [10, 12, 14, 15, 18]\r
# B群：外れ値を含むデータ（平均値比較だとBが勝ってしまうかも？）\r
group_B = [20, 22, 25, 26, 1000] \r
\r
# マン・ホイットニーのU検定（順位に基づいた検定）\r
u_stat, p_val = stats.mannwhitneyu(group_A, group_B, alternative='two-sided')\r
\r
print(f"U統計量: {u_stat}")\r
print(f"p値: {p_val:.4f}")\r
\r
# ちなみにt検定だと...\r
t_stat, t_p_val = stats.ttest_ind(group_A, group_B)\r
print(f"t検定のp値: {t_p_val:.4f}")\r
\`\`\`\r
外れ値があっても、順位検定なら「B群の方が全体的に大きい」という傾向をロバストに捉えられます。\r
\r
## Rでの実装：ウィルコクソンの符号付順位検定\r
\r
対応のあるデータ（前後比較など）の差を検定します。\r
\r
\`\`\`r\r
# 対応のあるデータ (Before -> After)\r
before <- c(80, 75, 90, 60, 70)\r
after  <- c(85, 70, 95, 75, 80)\r
\r
# 差を計算\r
diff <- after - before\r
# 正の差: 4つ, 負の差: 1つ。\r
# 増えている傾向があるか？\r
\r
# ウィルコクソンの符号付順位検定\r
wilcox.test(before, after, paired=TRUE)\r
\`\`\`\r
\r
## まとめ\r
\r
*   **データが汚い、少ない、外れ値がある**ときは、迷わずノンパラメトリック検定を検討する。\r
*   具体的には、**値を「順位」に変換**して検定する。\r
*   代表選手は「マン・ホイットニーのU検定（2群比較）」と「クラスカル・ウォリス検定（3群比較）」。\r
`;export{r as default};
