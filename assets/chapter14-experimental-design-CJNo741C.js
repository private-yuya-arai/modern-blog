const r=`---\r
slug: "experimental-design-chapter14"\r
title: "実験計画法：少ない実験回数で最大の情報を得る科学"\r
date: "2025-11-29"\r
category: "統計学"\r
tags: ["統計検定準一級", "Python", "R", "実験計画法", "フィッシャーの三原則", "直交表"]\r
excerpt: "闇雲に実験しても時間とコストの無駄。効率的にデータを集め、要因の効果をあぶり出すための「実験のデザイン」手法、フィッシャーの三大原則と直交表を解説。"\r
image: "/images/doe.png"\r
---\r
\r
## この知識はいつ使うの？\r
\r
*   **製品開発**: 新しいケーキを作るとき、「小麦粉の種類」「砂糖の量」「焼き時間」のベストな組み合わせを見つけたいが、全部試すと100通り以上あって無理なとき。\r
*   **Webマーケティング**: ボタンの色、キャッチコピー、画像配置などを同時にテストし、どの要素が効いているかを知りたいとき。\r
*   **農場試験**: 土地の場所による栄養の偏りなどをキャンセルして、純粋な肥料の効果を測定したいとき。\r
\r
## フィッシャーの三原則\r
\r
近代統計学の父、R.A.フィッシャーが提唱した、実験を成功させるための3つの鉄則です。\r
\r
\`\`\`mermaid\r
graph TD\r
    Goal["正しい実験結果を得たい"]\r
    \r
    Goal --> P1["反復 (Replication)"]\r
    Goal --> P2["無作為化 (Randomization)"]\r
    Goal --> P3["局所管理 (Local Control)"]\r
    \r
    P1 --> Mean1["偶然の誤差を評価する<br>(1回じゃまぐれかわからない)"]\r
    P2 --> Mean2["系統的なバイアスを消す<br>(選ぶ癖をなくす)"]\r
    P3 --> Mean3["無駄なばらつきを減らす<br>(実験環境をブロック分け)"]\r
\`\`\`\r
\r
1.  **反復**: 同じ条件で何度か繰り返せ（推定精度の向上）。\r
2.  **無作為化**: 順番や配置をランダムにせよ（系統誤差の排除）。\r
3.  **局所管理**: 条件を揃えられる範囲（ブロック）を作って、その中で比較せよ（実験精度の向上）。\r
\r
## 直交表 (Orthogonal Array)\r
\r
「全部の組み合わせ（全要因実験）」をやると回数が爆発します。\r
そこで、**「相殺されるようにうまく組み合わせを間引いた表（直交表）」**を使うと、少ない回数で主要な効果を測定できます。\r
\r
例：$L_8$ 直交表なら、7つの要因があってもわずか8回の実験で検証できます。\r
\r
| 実験No | 因子A | 因子B | 因子C | 因子D ... |\r
| :--- | :--- | :--- | :--- | :--- |\r
| 1 | 1 | 1 | 1 | 1 |\r
| 2 | 1 | 1 | 2 | 2 |\r
| 3 | 1 | 2 | 1 | 2 |\r
| ... | ... | ... | ... | ... |\r
\r
## 実験デザインの種類\r
\r
| デザイン名 | 特徴 | 使いどころ |\r
| :--- | :--- | :--- |\r
| **完全無作為化法** | 単にランダムに割り付ける。 | 環境差がない簡単な実験。 |\r
| **乱塊法** (Block Design) | 局所管理を使う。似た条件のブロック内で比較。 | 性別や年齢層、日にちなどで条件が変わる場合。 |\r
| **ラテン方格法** | 2方向のブロック（行と列）で制御する。 | 「車の運転者」と「テスト走行の日数」両方の影響を消したい時など。 |\r
\r
## Pythonでの実装：分散分析表の作成\r
\r
実験データの解析には**分散分析 (ANOVA)** が使われます。\r
「要因Aの水準によって、結果に差があったか？」を検定します。\r
\r
\`\`\`python\r
import pandas as pd\r
import statsmodels.api as sm\r
from statsmodels.formula.api import ols\r
\r
# 実験データ（乱塊法のイメージ）\r
data = {\r
    'Block': ['B1']*3 + ['B2']*3 + ['B3']*3, # ブロック（例えば実験日）\r
    'Factor': ['Low', 'Med', 'High'] * 3,   # 要因（知りたいもの）\r
    'Yield': [10, 12, 14,  11, 13, 15,  9, 11, 13] # 結果\r
}\r
df = pd.DataFrame(data)\r
\r
# 分散分析モデル構築\r
# Yield ~ Factor + Block (ブロックも説明変数に入れるのがポイント)\r
model = ols('Yield ~ C(Factor) + C(Block)', data=df).fit()\r
\r
# ANOVA表の出力\r
anova_table = sm.stats.anova_lm(model, typ=2)\r
print(anova_table)\r
\`\`\`\r
Factorの確率(p値)が小さければ、「要因の水準によって有意な差がある（実験成功）」と判断できます。\r
\r
## Rでの実装：Tukeyの多重比較\r
\r
「差があることはわかった。じゃあ具体的に High は Low より優れているのか？」を知るために多重比較を行います。\r
\r
\`\`\`r\r
# 実験を模したデータ\r
y <- c(10, 12, 14, 11, 13, 15, 9, 11, 13)\r
factor <- factor(rep(c("Low", "Med", "High"), 3))\r
block <- factor(rep(c("B1", "B2", "B3"), each=3))\r
\r
# 分散分析\r
res <- aov(y ~ factor + block)\r
\r
# Tukeyの多重比較\r
TukeyHSD(res, "factor")\r
\`\`\`\r
\r
結果に \`High-Low\` などの比較と信頼区間が表示されます。\r
\r
## まとめ\r
\r
*   下手な実験を数打つよりも、**計画された実験（実験計画法）**を数回やるほうが価値がある。\r
*   **三原則（反復・無作為化・局所管理）**は、実験だけでなくA/Bテストやアンケート設計でも重要な指針。\r
*   組み合わせ爆発を防ぐには**直交表**などのテクニックを使う。解析には**分散分析**を使う。\r
`;export{r as default};
